(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f54dd12"],{"1c31":function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return o}));var n=a("b775");function r(t,e){return Object(n["a"])({url:"/reports/teacher-hours",method:"get",params:{startDate:t,endDate:e}})}function o(){return Object(n["a"])({url:"/reports/occupation-demand",method:"get"})}},"5d32":function(t,e,a){"use strict";a("bf6c")},b033:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-card",{attrs:{shadow:"never"}},[a("el-form",{staticClass:"filter-form",attrs:{inline:!0}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",loading:t.loading},on:{click:t.loadReport}},[t._v("刷新数据")])],1)],1)],1)],1),a("div",{staticClass:"data-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:16}},[a("el-card",{staticStyle:{"margin-bottom":"20px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("职业需求排名")]),a("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning"}},[t._v(" 统计时间: "+t._s(t.currentDate)+" ")])],1),t.reportData.length>0?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"data-table",attrs:{data:t.reportData,border:"",stripe:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",label:"排名",align:"center",width:"80"}}),a("el-table-column",{attrs:{label:"职业类型",prop:"occupationName",align:"center","min-width":"180"}}),a("el-table-column",{attrs:{label:"需求量",prop:"demandCount",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tag",{attrs:{type:t.getDemandTagType(n.demandCount)}},[t._v(" "+t._s(n.demandCount)+" ")])]}}],null,!1,538117780)}),a("el-table-column",{attrs:{label:"占比",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{staticClass:"percentage-value"},[t._v(" "+t._s(t.calculatePercentage(n.demandCount))+"% ")])]}}],null,!1,658374656)})],1):a("div",{staticClass:"no-data"},[a("el-empty",{attrs:{description:"暂无数据"}})],1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-card",{staticClass:"chart-card",attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("职业需求分布图")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"chart-container"},[t.reportData.length>0?a("div",{staticStyle:{height:"400px"},attrs:{id:"occupation-demand-chart"}}):a("div",{staticClass:"no-data"},[a("el-empty",{attrs:{description:"暂无数据"}})],1)])])],1)],1)],1)])},r=[],o=a("2909"),i=a("c7eb"),s=a("1da1"),c=(a("d81d"),a("13d5"),a("fb6a"),a("b680"),a("d3b7"),a("0643"),a("a573"),a("9d4a"),a("1c31")),l=a("313e"),d={name:"OccupationDemandReport",data:function(){return{loading:!0,reportData:[],chartInstance:null,currentDate:(new Date).toLocaleDateString()}},mounted:function(){this.loadReport()},beforeDestroy:function(){this.chartInstance&&this.chartInstance.dispose()},methods:{loadReport:function(){var t=this;return Object(s["a"])(Object(i["a"])().mark((function e(){var a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,Object(c["a"])();case 4:a=e.sent,console.log("API Response:",a),2e4===a.code&&a.data.list?(t.reportData=a.data.list,t.$nextTick((function(){t.renderChart()}))):t.$message.error(a.message||"获取数据失败"),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),console.error("获取职业需求统计失败:",e.t0),t.$message.error("获取统计数据失败");case 13:return e.prev=13,t.loading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,9,13,16]])})))()},renderChart:function(){var t=this;if(0!==this.reportData.length){var e=this.reportData.slice(0,10).map((function(t){return{value:t.demandCount,name:t.occupationName}})),a=document.getElementById("occupation-demand-chart");if(a){this.chartInstance=l["a"](a);var n={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,top:"center",formatter:function(t){return t.length>8?t.substring(0,8)+"...":t}},series:[{name:"职业需求",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:e}]};this.chartInstance.setOption(n),window.addEventListener("resize",(function(){t.chartInstance&&t.chartInstance.resize()}))}}},calculatePercentage:function(t){var e=this.reportData.reduce((function(t,e){return t+e.demandCount}),0);return e>0?(t/e*100).toFixed(2):"0.00"},getDemandTagType:function(t){var e=Math.max.apply(Math,Object(o["a"])(this.reportData.map((function(t){return t.demandCount}))));return t>=.8*e?"danger":t>=.5*e?"warning":"success"}}},u=d,p=(a("5d32"),a("2877")),h=Object(p["a"])(u,n,r,!1,null,"01ed2721",null);e["default"]=h.exports},bf6c:function(t,e,a){}}]);