(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a37eafc2"],{"0ccb":function(e,t,i){var a=i("50c4"),n=i("1148"),r=i("1d80"),l=Math.ceil,c=function(e){return function(t,i,c){var o,s,u=String(r(t)),d=u.length,h=void 0===c?" ":String(c),p=a(i);return p<=d||""==h?u:(o=p-d,s=n.call(h,l(o/h.length)),s.length>o&&(s=s.slice(0,o)),e?u+s:s+u)}};e.exports={start:c(!1),end:c(!0)}},1148:function(e,t,i){"use strict";var a=i("a691"),n=i("1d80");e.exports="".repeat||function(e){var t=String(n(this)),i="",r=a(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(i+=t);return i}},"14c3":function(e,t,i){var a=i("c6b6"),n=i("9263");e.exports=function(e,t){var i=e.exec;if("function"===typeof i){var r=i.call(e,t);if("object"!==typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==a(e))throw TypeError("RegExp#exec called on incompatible receiver");return n.call(e,t)}},"25f0":function(e,t,i){"use strict";var a=i("6eeb"),n=i("825a"),r=i("d039"),l=i("ad6d"),c="toString",o=RegExp.prototype,s=o[c],u=r((function(){return"/a/b"!=s.call({source:"a",flags:"b"})})),d=s.name!=c;(u||d)&&a(RegExp.prototype,c,(function(){var e=n(this),t=String(e.source),i=e.flags,a=String(void 0===i&&e instanceof RegExp&&!("flags"in o)?l.call(e):i);return"/"+t+"/"+a}),{unsafe:!0})},"2c3e":function(e,t,i){var a=i("83ab"),n=i("9f7f").UNSUPPORTED_Y,r=i("9bf2").f,l=i("69f3").get,c=RegExp.prototype;a&&n&&r(RegExp.prototype,"sticky",{configurable:!0,get:function(){if(this!==c){if(this instanceof RegExp)return!!l(this).sticky;throw TypeError("Incompatible receiver, RegExp required")}}})},"4d63":function(e,t,i){var a=i("83ab"),n=i("da84"),r=i("94ca"),l=i("7156"),c=i("9bf2").f,o=i("241c").f,s=i("44e7"),u=i("ad6d"),d=i("9f7f"),h=i("6eeb"),p=i("d039"),g=i("69f3").set,f=i("2626"),m=i("b622"),b=m("match"),v=n.RegExp,y=v.prototype,S=/a/g,x=/a/g,$=new v(S)!==S,D=d.UNSUPPORTED_Y,E=a&&r("RegExp",!$||D||p((function(){return x[b]=!1,v(S)!=S||v(x)==x||"/a/i"!=v(S,"i")})));if(E){var I=function(e,t){var i,a=this instanceof I,n=s(e),r=void 0===t;if(!a&&n&&e.constructor===I&&r)return e;$?n&&!r&&(e=e.source):e instanceof I&&(r&&(t=u.call(e)),e=e.source),D&&(i=!!t&&t.indexOf("y")>-1,i&&(t=t.replace(/y/g,"")));var c=l($?new v(e,t):v(e,t),a?this:y,I);return D&&i&&g(c,{sticky:i}),c},T=function(e){e in I||c(I,e,{configurable:!0,get:function(){return v[e]},set:function(t){v[e]=t}})},w=o(v),k=0;while(w.length>k)T(w[k++]);y.constructor=I,I.prototype=y,h(n,"RegExp",I)}f("RegExp")},"4d90":function(e,t,i){"use strict";var a=i("23e7"),n=i("0ccb").start,r=i("9a0c");a({target:"String",proto:!0,forced:r},{padStart:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},5319:function(e,t,i){"use strict";var a=i("d784"),n=i("825a"),r=i("7b0b"),l=i("50c4"),c=i("a691"),o=i("1d80"),s=i("8aa5"),u=i("14c3"),d=Math.max,h=Math.min,p=Math.floor,g=/\$([$&'`]|\d\d?|<[^>]*>)/g,f=/\$([$&'`]|\d\d?)/g,m=function(e){return void 0===e?e:String(e)};a("replace",2,(function(e,t,i,a){var b=a.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,v=a.REPLACE_KEEPS_$0,y=b?"$":"$0";return[function(i,a){var n=o(this),r=void 0==i?void 0:i[e];return void 0!==r?r.call(i,n,a):t.call(String(n),i,a)},function(e,a){if(!b&&v||"string"===typeof a&&-1===a.indexOf(y)){var r=i(t,e,this,a);if(r.done)return r.value}var o=n(e),p=String(this),g="function"===typeof a;g||(a=String(a));var f=o.global;if(f){var x=o.unicode;o.lastIndex=0}var $=[];while(1){var D=u(o,p);if(null===D)break;if($.push(D),!f)break;var E=String(D[0]);""===E&&(o.lastIndex=s(p,l(o.lastIndex),x))}for(var I="",T=0,w=0;w<$.length;w++){D=$[w];for(var k=String(D[0]),_=d(h(c(D.index),p.length),0),C=[],O=1;O<D.length;O++)C.push(m(D[O]));var R=D.groups;if(g){var j=[k].concat(C,_,p);void 0!==R&&j.push(R);var Q=String(a.apply(void 0,j))}else Q=S(k,p,_,C,R,a);_>=T&&(I+=p.slice(T,_)+Q,T=_+k.length)}return I+p.slice(T)}];function S(e,i,a,n,l,c){var o=a+e.length,s=n.length,u=f;return void 0!==l&&(l=r(l),u=g),t.call(c,u,(function(t,r){var c;switch(r.charAt(0)){case"$":return"$";case"&":return e;case"`":return i.slice(0,a);case"'":return i.slice(o);case"<":c=l[r.slice(1,-1)];break;default:var u=+r;if(0===u)return t;if(u>s){var d=p(u/10);return 0===d?t:d<=s?void 0===n[d-1]?r.charAt(1):n[d-1]+r.charAt(1):t}c=n[u-1]}return void 0===c?"":c}))}}))},6303:function(e,t,i){},"745a":function(e,t,i){"use strict";i("6303")},"8aa5":function(e,t,i){"use strict";var a=i("6547").charAt;e.exports=function(e,t,i){return t+(i?a(e,t).length:1)}},"9a0c":function(e,t,i){var a=i("342f");e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a)},b2f0:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("div",{staticClass:"filter-form"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"输入教师ID",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.teacherId,callback:function(t){e.$set(e.listQuery,"teacherId",t)},expression:"listQuery.teacherId"}}),i("el-date-picker",{staticClass:"filter-item",staticStyle:{width:"200px","margin-right":"10px"},attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.listQuery.date,callback:function(t){e.$set(e.listQuery,"date",t)},expression:"listQuery.date"}}),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(" 搜索 ")]),i("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v(" 添加排班 ")])],1)]),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"scheduleTable",staticClass:"data-table",attrs:{data:e.list,"element-loading-text":"数据加载中",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{label:"ID",prop:"scheduleId",align:"center","min-width":"100"}}),i("el-table-column",{attrs:{label:"职业ID",prop:"occupationId",align:"center","min-width":"100"}}),i("el-table-column",{attrs:{label:"教师ID",prop:"teacherId",align:"center","min-width":"100"}}),i("el-table-column",{attrs:{label:"日期",align:"center","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"date-cell"},[e._v(e._s(e.formatDate(a.date)))])]}}])}),i("el-table-column",{attrs:{label:"开始时间",align:"center","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"time-cell"},[e._v(e._s(e.formatTime(a.startTime)))])]}}])}),i("el-table-column",{attrs:{label:"结束时间",align:"center","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"time-cell"},[e._v(e._s(e.formatTime(a.endTime)))])]}}])}),i("el-table-column",{attrs:{label:"操作",align:"center","min-width":"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.handleUpdate(a)}}},[e._v(" 编辑 ")]),i("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(a)}}},[e._v(" 删除 ")])]}}])})],1),i("el-pagination",{staticClass:"custom-pagination",attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,50,100],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.listQuery,"page",t)},"update:current-page":function(t){return e.$set(e.listQuery,"page",t)},"update:pageSize":function(t){return e.$set(e.listQuery,"limit",t)},"update:page-size":function(t){return e.$set(e.listQuery,"limit",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),i("schedule-dialog",{attrs:{visible:e.dialogVisible,type:e.dialogType,"schedule-data":e.tempSchedule,rules:e.rules,submitting:e.dialogSubmitting},on:{"update:visible":[function(t){e.dialogVisible=t},function(t){return e.dialogVisible=t}],submit:e.handleDialogSubmit,"update:submitting":function(t){return e.dialogSubmitting=t}}})],1)},n=[],r=i("5530"),l=(i("d3b7"),i("ed08")),c=i("b775");function o(e){return Object(c["a"])({url:"/occupation-schedules",method:"get",params:e})}function s(e){return Object(c["a"])({url:"/occupation-schedules",method:"post",data:e})}function u(e,t){return Object(c["a"])({url:"/occupation-schedules/".concat(e),method:"put",data:t})}function d(e){return Object(c["a"])({url:"/occupation-schedules/".concat(e),method:"delete"})}var h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"create"===e.dialogType?"添加排班":"编辑排班",visible:e.dialogVisible,width:"650px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[i("el-form",{ref:"scheduleForm",attrs:{model:e.tempSchedule,rules:e.rules,"label-width":"120px","label-position":"right"}},[i("el-form-item",{attrs:{label:"职业ID",prop:"occupationId"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,placeholder:"请输入职业ID","controls-position":"right"},model:{value:e.tempSchedule.occupationId,callback:function(t){e.$set(e.tempSchedule,"occupationId",t)},expression:"tempSchedule.occupationId"}})],1),i("el-form-item",{attrs:{label:"教师ID",prop:"teacherId"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,placeholder:"请输入教师ID","controls-position":"right"},model:{value:e.tempSchedule.teacherId,callback:function(t){e.$set(e.tempSchedule,"teacherId",t)},expression:"tempSchedule.teacherId"}})],1),i("el-form-item",{attrs:{label:"日期",prop:"date"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.tempSchedule.date,callback:function(t){e.$set(e.tempSchedule,"date",t)},expression:"tempSchedule.date"}})],1),i("el-form-item",{attrs:{label:"开始时间",prop:"startTime"}},[i("el-time-select",{staticStyle:{width:"100%"},attrs:{"picker-options":{start:"06:00",step:"00:15",end:"22:00"},placeholder:"开始时间"},model:{value:e.tempSchedule.startTime,callback:function(t){e.$set(e.tempSchedule,"startTime",t)},expression:"tempSchedule.startTime"}})],1),i("el-form-item",{attrs:{label:"结束时间",prop:"endTime"}},[i("el-time-select",{staticStyle:{width:"100%"},attrs:{"picker-options":{start:"06:00",step:"00:15",end:"22:00",minTime:e.tempSchedule.startTime},placeholder:"结束时间"},model:{value:e.tempSchedule.endTime,callback:function(t){e.$set(e.tempSchedule,"endTime",t)},expression:"tempSchedule.endTime"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{disabled:e.submitting},on:{click:e.close}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",loading:e.submitting},on:{click:e.handleSubmit}},[e._v(" 确认 ")])],1)],1)},p=[],g={name:"ScheduleDialog",props:{visible:Boolean,type:String,scheduleData:{type:Object,default:function(){return{}}},rules:{type:Object,default:function(){return{}}},submitting:Boolean},data:function(){return{dialogVisible:this.visible,dialogType:this.type,tempSchedule:this.getDefaultSchedule()}},watch:{visible:function(e){this.dialogVisible=e},type:function(e){this.dialogType=e},scheduleData:{immediate:!0,deep:!0,handler:function(e){this.tempSchedule=Object(r["a"])(Object(r["a"])({},this.getDefaultSchedule()),e),this.tempSchedule.date&&(this.tempSchedule.date=Object(l["b"])(this.tempSchedule.date,"{y}-{m}-{d}"))}}},methods:{getDefaultSchedule:function(){return{scheduleId:null,occupationId:null,teacherId:null,date:null,startTime:null,endTime:null}},handleClose:function(){this.$emit("update:visible",!1),this.$emit("update:submitting",!1)},close:function(){this.dialogVisible=!1,this.$emit("update:visible",!1),this.$emit("update:submitting",!1)},handleSubmit:function(){var e=this;this.$refs.scheduleForm.validate((function(t){t&&(e.$emit("update:submitting",!0),e.$emit("submit",{type:e.dialogType,data:Object(r["a"])({},e.tempSchedule)}))}))}}},f=g,m=i("2877"),b=Object(m["a"])(f,h,p,!1,null,null,null),v=b.exports,y={name:"OccupationScheduleList",components:{ScheduleDialog:v},data:function(){var e=this,t=function(t,i,a){if(e.tempSchedule.startTime&&e.tempSchedule.endTime){var n=e.tempSchedule.startTime,r=e.tempSchedule.endTime;if(n>=r)return void a(new Error("结束时间必须大于开始时间"))}a()};return{list:[],listLoading:!1,total:0,dialogVisible:!1,dialogSubmitting:!1,dialogType:"create",tempSchedule:this.getDefaultSchedule(),listQuery:{page:1,limit:10,teacherId:null,date:null},rules:{occupationId:[{required:!0,message:"职业ID不能为空",trigger:"blur"},{type:"number",min:1,message:"职业ID必须大于0",trigger:"blur"}],teacherId:[{required:!0,message:"教师ID不能为空",trigger:"blur"},{type:"number",min:1,message:"教师ID必须大于0",trigger:"blur"}],date:[{required:!0,message:"日期不能为空",trigger:"change"}],startTime:[{required:!0,message:"开始时间不能为空",trigger:"change"}],endTime:[{required:!0,message:"结束时间不能为空",trigger:"change"},{validator:t,trigger:"change"}]}}},created:function(){this.fetchData()},mounted:function(){window.addEventListener("resize",this.doLayout)},beforeDestroy:function(){window.removeEventListener("resize",this.doLayout)},methods:{doLayout:function(){this.$refs.scheduleTable&&this.$refs.scheduleTable.doLayout()},fetchData:function(){var e=this;this.listLoading=!0;var t=Object(r["a"])(Object(r["a"])({pageNum:this.listQuery.page,pageSize:this.listQuery.limit},this.listQuery.teacherId&&{teacherId:this.listQuery.teacherId}),this.listQuery.date&&{date:this.listQuery.date});o(t).then((function(t){var i,a;2e4===t.code?(e.list=(null===(i=t.data)||void 0===i||null===(i=i.page)||void 0===i?void 0:i.records)||[],e.total=(null===(a=t.data)||void 0===a||null===(a=a.page)||void 0===a?void 0:a.total)||0):e.$message.error(t.message||"获取数据失败")})).catch((function(t){console.error("获取排班失败:",t),e.$message.error("获取数据失败: "+(t.message||"请稍后重试"))})).finally((function(){e.listLoading=!1,e.$nextTick((function(){e.doLayout()}))}))},handleFilter:function(){this.listQuery.page=1,this.fetchData()},handleSizeChange:function(e){this.listQuery.limit=e,this.fetchData()},handleCurrentChange:function(e){this.listQuery.page=e,this.fetchData()},getDefaultSchedule:function(){return{scheduleId:null,occupationId:null,teacherId:null,date:null,startTime:null,endTime:null}},handleCreate:function(){this.dialogType="create",this.tempSchedule=this.getDefaultSchedule(),this.dialogVisible=!0,this.dialogSubmitting=!1},handleUpdate:function(e){this.dialogType="update",this.tempSchedule=Object(r["a"])({},e),this.dialogVisible=!0,this.dialogSubmitting=!1},handleDialogSubmit:function(e){var t=e.type,i=e.data;"create"===t?this.createData(i):this.updateData(i)},createData:function(e){var t=this,i=Object(r["a"])(Object(r["a"])({},e),{},{date:e.date||Object(l["b"])(new Date,"{y}-{m}-{d}")});s(i).then((function(e){2e4===e.code?(t.$message.success("创建成功"),t.dialogVisible=!1,t.dialogSubmitting=!1,t.fetchData()):50008===e.code?(t.$message.error(e.message||"时间段冲突，请重新选择"),t.dialogSubmitting=!1):(t.$message.error(e.message||"创建失败"),t.dialogSubmitting=!1)})).catch((function(e){console.error("创建排班失败:",e),t.$message.error("创建失败: "+(e.message||"请稍后重试")),t.dialogSubmitting=!1}))},updateData:function(e){var t=this;if(!e.scheduleId)return this.$message.error("无效的排班ID"),void(this.dialogSubmitting=!1);u(e.scheduleId,e).then((function(e){2e4===e.code?(t.$message.success("更新成功"),t.dialogVisible=!1,t.dialogSubmitting=!1,t.fetchData()):50008===e.code?(t.$message.error(e.message||"时间段冲突，请重新选择"),t.dialogSubmitting=!1):(t.$message.error(e.message||"更新失败"),t.dialogSubmitting=!1)})).catch((function(e){console.error("更新排班失败:",e),t.$message.error("更新失败: "+(e.message||"请稍后重试")),t.dialogSubmitting=!1}))},handleDelete:function(e){var t=this;this.$confirm("确定删除ID为 ".concat(e.scheduleId," 的排班记录吗？"),"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return t.listLoading=!0,d(e.scheduleId)})).then((function(e){2e4===e.code?(t.$message.success("删除成功"),1===t.list.length&&t.listQuery.page>1&&(t.listQuery.page-=1),t.fetchData()):t.$message.error(e.message||"删除失败")})).catch((function(e){"cancel"!==e&&(console.error("删除失败:",e),t.$message.error("删除失败: "+(e.message||"请稍后重试")))})).finally((function(){t.listLoading=!1}))},formatDate:function(e){return e?10===e.length?e:Object(l["b"])(e,"{y}-{m}-{d}"):""},formatTime:function(e){return e?5===e.length?e:e.substring(0,5):""}}},S=y,x=(i("745a"),Object(m["a"])(S,a,n,!1,null,"460cd812",null));t["default"]=x.exports},d784:function(e,t,i){"use strict";i("ac1f");var a=i("6eeb"),n=i("d039"),r=i("b622"),l=i("9263"),c=i("9112"),o=r("species"),s=!n((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),d=r("replace"),h=function(){return!!/./[d]&&""===/./[d]("a","$0")}(),p=!n((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2!==i.length||"a"!==i[0]||"b"!==i[1]}));e.exports=function(e,t,i,d){var g=r(e),f=!n((function(){var t={};return t[g]=function(){return 7},7!=""[e](t)})),m=f&&!n((function(){var t=!1,i=/a/;return"split"===e&&(i={},i.constructor={},i.constructor[o]=function(){return i},i.flags="",i[g]=/./[g]),i.exec=function(){return t=!0,null},i[g](""),!t}));if(!f||!m||"replace"===e&&(!s||!u||h)||"split"===e&&!p){var b=/./[g],v=i(g,""[e],(function(e,t,i,a,n){return t.exec===l?f&&!n?{done:!0,value:b.call(t,i,a)}:{done:!0,value:e.call(i,t,a)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:h}),y=v[0],S=v[1];a(String.prototype,e,y),a(RegExp.prototype,g,2==t?function(e,t){return S.call(e,this,t)}:function(e){return S.call(e,this)})}d&&c(RegExp.prototype[g],"sham",!0)}},ed08:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));var a=i("53ca");i("d3b7"),i("4d63"),i("ac1f"),i("2c3e"),i("00b4"),i("25f0"),i("4d90"),i("5319"),i("0643"),i("4e3e"),i("159b");function n(e,t){if(0===arguments.length||!e)return null;var i,n=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(a["a"])(e)?i=e:("string"===typeof e&&(e=/^[0-9]+$/.test(e)?parseInt(e):e.replace(new RegExp(/-/gm),"/")),"number"===typeof e&&10===e.toString().length&&(e*=1e3),i=new Date(e));var r={y:i.getFullYear(),m:i.getMonth()+1,d:i.getDate(),h:i.getHours(),i:i.getMinutes(),s:i.getSeconds(),a:i.getDay()},l=n.replace(/{([ymdhisa])+}/g,(function(e,t){var i=r[t];return"a"===t?["日","一","二","三","四","五","六"][i]:i.toString().padStart(2,"0")}));return l}function r(e){if(!e)return"";var t=e.replace(/\D/g,"");return 11===t.length?t.replace(/(\d{3})(\d{4})(\d{4})/,"$1 $2 $3"):10===t.length?t.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"):e}}}]);